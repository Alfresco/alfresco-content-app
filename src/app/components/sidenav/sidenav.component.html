<div class="sidenav">
    <div class="sidenav__section sidenav__section sidenav_action-menu">
        <app-create-menu [expanded]="showLabel"></app-create-menu>
    </div>

    <div *ngFor="let group of groups; trackBy: trackById"
            class="sidenav__section sidenav__section--menu">

            <div class="sidenav-menu">
                <div *ngFor="let item of group.items; trackBy: trackById"
                    routerLinkActive
                    #routerLink="routerLinkActive">

                    <ng-container *ngIf="showLabel">
                        <ng-container *ngIf="!item.children">
                            <div class="sidenav-menu__item">
                                <button [id]="item.id"
                                    mat-icon-button mat-ripple
                                    [routerLink]="item.url"
                                    [color]="routerLink.isActive ? 'accent': 'primary'"
                                    [attr.aria-label]="item.title | translate"
                                    matRippleColor="primary"
                                    [matRippleTrigger]="rippleTrigger"
                                    [matRippleCentered]="true"
                                    [matRippleRadius]="20">

                                    <mat-icon>{{ item.icon }}</mat-icon>
                                </button>

                                <span #rippleTrigger
                                    class="menu__item--label"
                                    [routerLink]="item.url"
                                    [attr.aria-label]="item.title | translate"
                                    [ngClass]="{
                                        'menu__item--active': routerLink.isActive,
                                        'menu__item--default': !routerLink.isActive
                                    }">
                                    {{ item.title | translate }}</span>
                            </div>
                        </ng-container>

                        <ng-container *ngIf="item.children && item.children.length">
                            <mat-expansion-panel [expanded]="routerLink.isActive" [@.disabled]="true">
                                <mat-expansion-panel-header expandedHeight="48px" collapsedHeight="48px" [id]="item.id">
                                    <mat-panel-title>
                                        <mat-icon [color]="routerLink.isActive? 'accent': 'primary'">{{ item.icon }}</mat-icon>
                                        <span class="menu__item--label"
                                            [ngClass]="{
                                                'menu__item--active': routerLink.isActive,
                                                'menu__item--default': !routerLink.isActive
                                            }">
                                            {{ item.title | translate }}</span>
                                    </mat-panel-title>
                                </mat-expansion-panel-header>

                                <div *ngFor="let child of item.children; trackBy: trackById"
                                    routerLinkActive #childRouteActive="routerLinkActive"
                                    [attr.title]="child.description | translate">

                                    <button [id]="child.id"
                                        mat-icon-button mat-ripple
                                        [routerLink]="child.url"
                                        [color]="childRouteActive.isActive ? 'accent': 'primary'"
                                        [attr.aria-label]="child.title | translate"
                                        matRippleColor="primary"
                                        [matRippleTrigger]="rippleTrigger"
                                        [matRippleCentered]="true"
                                        [matRippleRadius]="20">

                                        <mat-icon>{{ child.icon }}</mat-icon>
                                    </button>

                                    <span #rippleTrigger
                                        [routerLink]="child.url"
                                        class="menu__item--label"
                                        [ngClass]="{
                                            'menu__item--active': childRouteActive.isActive,
                                            'menu__item--default': !childRouteActive.isActive
                                        }">
                                        {{ child.title | translate }}</span>
                                </div>
                            </mat-expansion-panel>
                        </ng-container>
                    </ng-container>

                    <ng-container *ngIf="!showLabel">
                        <ng-container *ngIf="!item.children">
                                <div class="sidenav-menu__item">
                                    <button [id]="item.id"
                                        mat-icon-button [routerLink]="item.url"
                                        [color]="routerLink.isActive ? 'accent': 'primary'"
                                        [attr.aria-label]="item.title | translate">

                                        <mat-icon>{{ item.icon }}</mat-icon>
                                    </button>
                                </div>
                            </ng-container>

                            <ng-container *ngIf="item.children && item.children.length">
                                <div class="sidenav-menu__item">
                                    <button [id]="item.id"
                                        color="accent" mat-icon-button
                                        #childMenu="matMenuTrigger"
                                        [matMenuTriggerFor]="menu">
                                        <mat-icon [color]="routerLink.isActive|| childMenu.menuOpen? 'accent': 'primary'">
                                            {{ item.icon }}more_vert
                                        </mat-icon>
                                    </button>
                                </div>

                                <mat-menu #menu="matMenu"[overlapTrigger]="false">
                                    <button mat-menu-item
                                        *ngFor="let child of item.children; trackBy: trackById"
                                        routerLinkActive
                                        #menuRouterLink="routerLinkActive"
                                        [routerLink]="child.url"
                                        [id]="child.id">

                                        <mat-icon [color]="menuRouterLink.isActive ? 'primary': null"
                                            [attr.color]="menuRouterLink.isActive ? 'primary': null">
                                            {{ child.icon }}
                                        </mat-icon>

                                        <span class="mat-button" [ngClass]="{ 'mat-primary': menuRouterLink.isActive }">
                                            {{ child.title | translate }}
                                        </span>
                                    </button>
                                </mat-menu>
                            </ng-container>
                    </ng-container>
                </div>
            </div>
    </div>
    </div>