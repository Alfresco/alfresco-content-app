name: "Download build artifacts"
description: "Download build artifacts"

inputs:
  artifact:
    description: 'path to the s3 artifact (tar.bz2) to download and extract'
    required: true
    type: string
  output:
    description: 'directory to extract the archive to'
    required: true
    type: string

runs:
  using: "composite"
  steps:
    - name: install aws cli
      shell: bash
      run: pip install awscli
    - name: download build artifacts from s3
      shell: bash
      run: |
        test ! -d ${{ inputs.output }} && mkdir -p ${{ inputs.output }}
        aws s3 cp ${{ inputs.artifact }} ./s3-artifact.tmp
        echo 'artifact download done'
        tar -xvf ./s3-artifact.tmp -C ${{ inputs.output }} >&/dev/null
        echo 'tar the artifact done'
        rm ./s3-artifact.tmp
        echo 'remove tmp file'
